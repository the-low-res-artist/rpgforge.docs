# ---------------------------------------------------------------
# variables
root_dir=${PWD}

# ---------------------------------------------------------------
# keep current website as backup
mv ./book ./book.sav

# ---------------------------------------------------------------
# PRE BUILD SCRIPTS
cd ${root_dir}/scripts

# update the glossary to each src/*.md page
python3 -m glossary.py

cd ${root_dir}
# ---------------------------------------------------------------
# BUILD SCRIPTS
#cd ${root_dir}/src/en/stable
mdbook build ${root_dir}/src/en/stable -d ${root_dir}/book/en/stable

# ---------------------------------------------------------------
# POST BUILD SCRIPTS
cd ${root_dir}/scripts

# add the dropdown "Version" on each *.html page generated by mdbook
python3 -m version.py -d ${root_dir}/book/en/stable
# add the dropdown "Langage" on each *.html page generated by mdbook
python3 -m langage.py -d ${root_dir}/book/en/stable
# fix link format (remove '.html' endings for external links)
python3 -m link.py

# back to root folder
cd ${root_dir}

ln -s ${root_dir}/media/ ${root_dir}/book/en/stable/media


